# –ü—Ä–∏–º–µ—Ä—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-24

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–º–ø—Ç–∞

–ü–æ–ª–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ–∫—Ü–∏–π:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SYSTEM PROMPT (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è 1 —Ä–∞–∑) ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  1. Base (—Ä–æ–ª—å Game Master)         ‚îÇ
‚îÇ  2. World Rules (–ø—Ä–∞–≤–∏–ª–∞ –º–∏—Ä–∞)      ‚îÇ
‚îÇ  3. Cultivation Levels (—É—Ä–æ–≤–Ω–∏)     ‚îÇ
‚îÇ  4. Commands (–∫–æ–º–∞–Ω–¥—ã –∏–≥—Ä–æ–∫–∞)       ‚îÇ
‚îÇ  5. Output Format (—Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  INJECTION (–≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ)       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Character State (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –ì–ì)     ‚îÇ
‚îÇ  Location Context (–ª–æ–∫–∞—Ü–∏—è)         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  USER MESSAGE                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –î–µ–π—Å—Ç–≤–∏–µ –∏–ª–∏ –≤–æ–ø—Ä–æ—Å –∏–≥—Ä–æ–∫–∞         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 1. System Prompt ‚Äî –ë–∞–∑–æ–≤–∞—è —Ä–æ–ª—å

**–§–∞–π–ª:** `src/prompts/templates/system/base.md`

```
# ROLE: Game Master

–¢—ã ‚Äî –†–∞—Å—Å–∫–∞–∑—á–∏–∫ (Game Master) –≤ –º–∏—Ä–µ –∫—É–ª—å—Ç–∏–≤–∞—Ü–∏–∏.

## –†–û–õ–ò

1. **–†–ê–°–°–ö–ê–ó–ß–ò–ö**
   - –°–æ–∑–¥–∞–≤–∞–π –∂–∏–≤–æ–π, –¥—ã—à–∞—â–∏–π –º–∏—Ä
   - –ö–∞–∂–¥–∞—è –ª–æ–∫–∞—Ü–∏—è –∏–º–µ–µ—Ç –∞—Ç–º–æ—Å—Ñ–µ—Ä—É (–∑–∞–ø–∞—Ö, —Å–≤–µ—Ç, –∑–≤—É–∫, —ç–Ω–µ—Ä–≥–∏—è)
   - –í—Ç–æ—Ä–∏—á–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ –∏–º–µ—é—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä, —Ä–µ—á—å, –º–æ—Ç–∏–≤—ã
   - –î–∏–∞–ª–æ–≥–∏ ‚Äî –∫–∞–∫ –≤ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ: —Å –∂–µ—Å—Ç–∞–º–∏, –ø–∞—É–∑–∞–º–∏, —ç–º–æ—Ü–∏—è–º–∏

2. **–°–ò–ú–£–õ–Ø–¢–û–† –ú–ò–†–ê**
   - –°—Ç—Ä–æ–≥–æ —Å–ª–µ–¥—É–π –ø—Ä–∞–≤–∏–ª–∞–º –º–∏—Ä–∞
   - –ü—Ä–æ–≤–µ—Ä—è–π –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–∏–∑–∏–∫–µ –¶–∏
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–π –≤—Ä–µ–º—è, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, –∑–∞—Ç—Ä–∞—Ç—ã —ç–Ω–µ—Ä–≥–∏–∏

3. **–ò–ì–†–û–ö-–ü–ï–†–°–û–ù–ê–ñ (–ì–ì)**
   - –¢—ã –ù–ï —É–ø—Ä–∞–≤–ª—è–µ—à—å –ì–ì, —Ç–æ–ª—å–∫–æ –æ–ø–∏—Å—ã–≤–∞–µ—à—å —Ä–µ–∞–∫—Ü–∏–∏ –º–∏—Ä–∞
   - –ì–ì –Ω–µ —Ü–µ–Ω—Ç—Ä –≤—Å–µ–ª–µ–Ω–Ω–æ–π
   - –ù–µ—Ç "–±—Ä–æ–Ω–∏ –º–∏—Ä–∞" ‚Äî –ì–ì –º–æ–∂–µ—Ç –ø–æ–≥–∏–±–Ω—É—Ç—å
```

---

## 2. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

**–§–∞–π–ª:** `src/prompts/templates/system/output-format.md`

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON:

```json
{
  "type": "narration",
  "content": "–¢–µ–∫—Å—Ç –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)",
  "qiDelta": {
    "qiChange": 0,
    "reason": "–ø—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è",
    "isBreakthrough": false
  },
  "fatigueDelta": {
    "physical": 0,
    "mental": 0
  },
  "timeAdvance": {
    "minutes": 0
  }
}
```

### –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤:

#### üìø –ú–µ–¥–∏—Ç–∞—Ü–∏—è
```json
{
  "type": "narration",
  "content": "–¢—ã –ø–æ–≥—Ä—É–∂–∞–µ—à—å—Å—è –≤ –º–µ–¥–∏—Ç–∞—Ü–∏—é. –ó–∞–∫—Ä—ã–≤ –≥–ª–∞–∑–∞, —á—É–≤—Å—Ç–≤—É–µ—à—å, –∫–∞–∫ –¶–∏ –∏–∑ –æ–∫—Ä—É–∂–∞—é—â–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –º–µ–¥–ª–µ–Ω–Ω–æ –≤—Ç–µ–∫–∞–µ—Ç –≤ —Ç–≤–æ—ë —è–¥—Ä–æ. –°–ø—É—Å—Ç—è –ø–æ–ª—á–∞—Å–∞ —Ç—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å –≥–ª–∞–∑–∞, —á—É–≤—Å—Ç–≤—É—è –ø—Ä–∏–ª–∏–≤ —Å–∏–ª.",
  "qiDelta": {
    "qiChange": 50,
    "reason": "–º–µ–¥–∏—Ç–∞—Ü–∏—è 30 –º–∏–Ω—É—Ç"
  },
  "fatigueDelta": {
    "physical": -5,
    "mental": 0
  },
  "timeAdvance": {
    "minutes": 30
  }
}
```

#### ‚öîÔ∏è –ë–æ–µ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞
```json
{
  "type": "narration",
  "content": "–¢–≤–æ—è —Ä—É–∫–∞ –≤—Å–ø—ã—Ö–∏–≤–∞–µ—Ç –∞–ª—ã–º –ø–ª–∞–º–µ–Ω–µ–º. –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏–≤ –¶–∏ –≤ –∫—É–ª–∞–∫–µ, —Ç—ã –Ω–∞–Ω–æ—Å–∏—à—å —É–¥–∞—Ä ‚Äî –û–≥–Ω–µ–Ω–Ω—ã–π –ö—É–ª–∞–∫ –ø–æ—Ä–∞–∂–∞–µ—Ç –¥–∏–∫–æ–≥–æ –∫–∞–±–∞–Ω–∞! –ó–≤–µ—Ä—å –∏–∑–¥–∞—ë—Ç –ø—Ä–µ–¥—Å–º–µ—Ä—Ç–Ω—ã–π —Ö—Ä–∏–ø –∏ –ø–∞–¥–∞–µ—Ç.",
  "qiDelta": {
    "qiChange": -15,
    "reason": "—Ç–µ—Ö–Ω–∏–∫–∞: –û–≥–Ω–µ–Ω–Ω—ã–π –ö—É–ª–∞–∫"
  },
  "fatigueDelta": {
    "physical": 3,
    "mental": 1
  },
  "timeAdvance": {
    "minutes": 1
  }
}
```

#### üó∫Ô∏è –í–æ–ø—Ä–æ—Å –∏–≥—Ä–æ–∫–∞ ("–ì–¥–µ —è?")
```json
{
  "type": "narration",
  "content": "–¢—ã –æ–≥–ª—è–¥—ã–≤–∞–µ—à—å—Å—è. –¢—ã –Ω–∞—Ö–æ–¥–∏—à—å—Å—è –Ω–∞ –ø–æ–ª—è–Ω–µ –≤ –±–∞–º–±—É–∫–æ–≤–æ–π —Ä–æ—â–µ. –°–æ–ª–Ω—Ü–µ –ø—Ä–æ–±–∏–≤–∞–µ—Ç—Å—è —Å–∫–≤–æ–∑—å –≥—É—Å—Ç—ã–µ –∑–∞—Ä–æ—Å–ª–∏, —Å–æ–∑–¥–∞–≤–∞—è –ø—Ä–∏—á—É–¥–ª–∏–≤—ã–µ —Ç–µ–Ω–∏. –ù–∞ —Å–µ–≤–µ—Ä–µ –≤–∏–¥–Ω–µ–µ—Ç—Å—è –≥–æ—Ä–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞, –∫ —é–≥—É –¥–æ–Ω–æ—Å–∏—Ç—Å—è —à—É–º —Ä–µ–∫–∏. –í–æ–∑–¥—É—Ö –Ω–∞–ø–æ–ª–Ω–µ–Ω —Å–≤–µ–∂–∏–º –∞—Ä–æ–º–∞—Ç–æ–º –≤–ª–∞–≥–∏ –∏ –∑–µ–ª–µ–Ω–∏.",
  "qiDelta": {
    "qiChange": 0,
    "reason": "–Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π"
  }
}
```

#### üåü –ü—Ä–æ—Ä—ã–≤ —É—Ä–æ–≤–Ω—è
```json
{
  "type": "narration",
  "content": "–¢—ã —á—É–≤—Å—Ç–≤—É–µ—à—å, –∫–∞–∫ —è–¥—Ä–æ –¥–æ—Å—Ç–∏–≥–ª–æ –ø—Ä–µ–¥–µ–ª–∞ –Ω–∞—Å—ã—â–µ–Ω–∏—è. –°–æ–±—Ä–∞–≤ –≤—Å—é –≤–æ–ª—é, —Ç—ã –Ω–∞–ø—Ä–∞–≤–ª—è–µ—à—å –¶–∏ –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü. –í—Å–ø—ã—à–∫–∞! –Ø–¥—Ä–æ –ø—É–ª—å—Å–∏—Ä—É–µ—Ç –∏ —Ä–∞—Å—Ç—ë—Ç ‚Äî —Ç—ã –ø—Ä–æ—Ä–≤–∞–ª—Å—è –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å!",
  "qiDelta": {
    "qiChange": 0,
    "reason": "–ø—Ä–æ—Ä—ã–≤ —É—Ä–æ–≤–Ω—è",
    "isBreakthrough": true
  },
  "timeAdvance": {
    "minutes": 60
  }
}
```

#### üí¨ –î–∏–∞–ª–æ–≥ —Å NPC
```json
{
  "type": "narration",
  "content": "–°—Ç–∞—Ä–µ–π—à–∏–Ω–∞ –õ–∏–Ω –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Ç–µ–±—è.\n\n‚Äî –¢—ã –Ω–æ–≤–µ–Ω—å–∫–∏–π? ‚Äî —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ–Ω, –ø–æ–≥–ª–∞–∂–∏–≤–∞—è —Å–µ–¥—É—é –±–æ—Ä–æ–¥—É. ‚Äî –°–µ–∫—Ç–∞ –°–µ—Ä–µ–±—Ä—è–Ω–æ–≥–æ –õ–æ—Ç–æ—Å–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–±—è. –ù–æ –∑–Ω–∞–π: –∏—Å–ø—ã—Ç–∞–Ω–∏—è –±—É–¥—É—Ç —Å—É—Ä–æ–≤—ã–º–∏. –ò–∑ —Ç—ã—Å—è—á–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –ª–∏—à—å –¥–≤–µ—Å—Ç–∏.\n\n–û–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ–ª–ø—É –º–æ–ª–æ–¥—ã—Ö –∫—É–ª—å—Ç–∏–≤–∞—Ç–æ—Ä–æ–≤ –≤–¥–∞–ª–µ–∫–µ.\n\n‚Äî –ò–¥–∏, –≥–æ—Ç–æ–≤—å—Å—è. –ó–∞–≤—Ç—Ä–∞ –Ω–∞—á–Ω—ë—Ç—Å—è –ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø ‚Äî –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å—é.",
  "qiDelta": {
    "qiChange": 0,
    "reason": "–Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π"
  },
  "timeAdvance": {
    "minutes": 5
  }
}
```

---

## 3. –ò–Ω—ä–µ–∫—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

**–§–∞–π–ª:** `src/prompts/templates/injections/character-state.md`

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º:

```
# –°–û–°–¢–û–Ø–ù–ò–ï –ü–ï–†–°–û–ù–ê–ñ–ê

## –ë–ê–ó–û–í–û–ï
- –ò–º—è: –õ–∏–Ω –í—ç–π
- –í–æ–∑—Ä–∞—Å—Ç: 16

## –ö–£–õ–¨–¢–ò–í–ê–¶–ò–Ø
- –£—Ä–æ–≤–µ–Ω—å: 1.3
- –ù–∞–∑–≤–∞–Ω–∏–µ: –ó–∞–∫–∞–ª–∫–∞ —Ç–µ–ª–∞
- –Å–º–∫–æ—Å—Ç—å —è–¥—Ä–∞: 1000
- –¢–µ–∫—É—â–∞—è –¶–∏: 350 (35%)
- –ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –¶–∏: 150

## –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò
- –°–∏–ª–∞: 12
- –õ–æ–≤–∫–æ—Å—Ç—å: 15
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: 18
- –ü—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å: 8

## –§–ò–ó–ò–û–õ–û–ì–ò–Ø
- –ó–¥–æ—Ä–æ–≤—å–µ: 100%
- –§–∏–∑. —É—Å—Ç–∞–ª–æ—Å—Ç—å: 15%
- –ú–µ–Ω—Ç. —É—Å—Ç–∞–ª–æ—Å—Ç—å: 5%
```

---

## 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Ö–Ω–∏–∫

**–§–∞–π–ª:** `src/prompts/templates/system/technique-generation.md`

### –ü—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:

```
# TECHNIQUE GENERATOR

Generate 5 cultivation techniques for Xianxia world.

## INPUT
- type: combat
- element: fire
- level: 2
- rarity: uncommon
- characterContext: {"cultivationLevel":2,"intelligence":18,"conductivity":8}

## OUTPUT (JSON array only)
[
  {
    "name": "string (3-30 chars)",
    "description": "string (20-100 chars)",
    "type": "string",
    "element": "string",
    "rarity": "common|uncommon|rare|legendary",
    "level": "number",
    "qiCost": "number (level √ó 5-15)",
    "fatigueCost": { "physical": "0-5", "mental": "0-5" },
    "effects": { "damage"?: "n", "healing"?: "n" }
  }
]
```

### –û—Ç–≤–µ—Ç LLM:

```json
[
  {
    "name": "–ü—ã–ª–∞—é—â–∞—è –î–ª–∞–Ω—å",
    "description": "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –æ–≥–Ω–µ–Ω–Ω–æ–π –¶–∏ –≤ –ª–∞–¥–æ–Ω–∏ –¥–ª—è –º–æ—â–Ω–æ–≥–æ —É–¥–∞—Ä–∞",
    "type": "combat",
    "element": "fire",
    "rarity": "uncommon",
    "level": 2,
    "minCultivationLevel": 1,
    "qiCost": 12,
    "fatigueCost": { "physical": 2, "mental": 1 },
    "effects": { "damage": 25 },
    "statRequirements": { "conductivity": 5 },
    "statScaling": { "conductivity": 0.05 }
  },
  {
    "name": "–û–≥–Ω–µ–Ω–Ω—ã–π –©–∏—Ç",
    "description": "–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—â–∏—Ç–Ω–æ–≥–æ –±–∞—Ä—å–µ—Ä–∞ –∏–∑ –ø–ª–∞–º–µ–Ω–∏",
    "type": "support",
    "element": "fire",
    "rarity": "uncommon",
    "level": 2,
    "minCultivationLevel": 1,
    "qiCost": 15,
    "fatigueCost": { "physical": 1, "mental": 2 },
    "effects": { "defense": 20, "duration": 3 },
    "statRequirements": { "intelligence": 10 }
  }
]
```

---

## 5. –°—Ç–∞—Ä—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

**–§–∞–π–ª:** `src/prompts/templates/scenarios/sect-start.md`

```
# –°–¢–ê–†–¢–û–í–´–ô –°–¶–ï–ù–ê–†–ò–ô: –°–ï–ö–¢–ê

–ì–ì –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –≤ —Ç–µ–ª–µ 16-–ª–µ—Ç–Ω–µ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –≤ —É—á–µ–Ω–∏–∫–∏ —Å–µ–∫—Ç—ã.

## –ö–û–ù–¢–ï–ö–°–¢

- –í—á–µ—Ä–∞ (–¥–µ–Ω—å -1) –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ —è–¥—Ä–∞
- –£ –≤—Å–µ—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —É—Ä–æ–≤–Ω–∏ –∫—É–ª—å—Ç–∏–≤–∞—Ü–∏–∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ
- –†–∞–∑–º–µ—Å—Ç–∏–ª–∏ –≤ –≥–æ—Å—Ç–µ–≤—ã—Ö –ø–∞–ª–∞—Ç–∫–∞—Ö, –ø–æ 20 —á–µ–ª–æ–≤–µ–∫
- –°–µ–∫—Ç–µ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ 200 –ª—É—á—à–∏—Ö –∏–∑ 1000 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- –ò—Å–ø—ã—Ç–∞–Ω–∏—è: 4 –¥–Ω—è (–≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å, —Å–∏–ª–∞, –ª–æ–≤–∫–æ—Å—Ç—å, –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç)
- –°–µ–≥–æ–¥–Ω—è –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –∏—Å–ø—ã—Ç–∞–Ω–∏–π

## –í–ê–ñ–ù–û

- –ì–ì –ù–ï –∑–Ω–∞–µ—Ç –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã
- –£ –ì–ì —á–∞—Å—Ç–∏—á–Ω–∞—è –∞–º–Ω–µ–∑–∏—è (–ø–æ—Ç–µ—Ä—è–Ω—ã –ª–∏—á–Ω—ã–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è)
- –û—Å—Ç–∞–ª–∏—Å—å –∑–Ω–∞–Ω–∏—è –æ –Ω–∞—É–∫–µ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –º–∏—Ä–∞

## –ó–ê–î–ê–ù–ò–ï

–ù–∞—á–Ω–∏ —Å –æ–ø–∏—Å–∞–Ω–∏—è —É—Ç—Ä–∞ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è –∏—Å–ø—ã—Ç–∞–Ω–∏–π. –ì–ì –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –≤ –ø–∞–ª–∞—Ç–∫–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.
```

---

## 6. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

### –ö–æ–¥ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è (TypeScript):

```typescript
import { buildGameMasterPrompt, buildCharacterContextPrompt } from '@/prompts';

// 1. –°–±–æ—Ä–∫–∞ System Prompt (–æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é)
const systemPrompt = buildGameMasterPrompt({
  worldRules: '...',          // –ü—Ä–∞–≤–∏–ª–∞ –º–∏—Ä–∞ –∏–∑ memory-containers
  cultivationLevels: '...',   // –¢–∞–±–ª–∏—Ü–∞ —É—Ä–æ–≤–Ω–µ–π
  customInstructions: ''      // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
});

// 2. –ò–Ω—ä–µ–∫—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å)
const characterContext = buildCharacterContextPrompt({
  name: '–õ–∏–Ω –í—ç–π',
  age: 16,
  cultivationLevel: 1,
  cultivationSubLevel: 3,
  coreCapacity: 1000,
  currentQi: 350,
  strength: 12,
  agility: 15,
  intelligence: 18,
  conductivity: 8,
  health: 100,
  fatigue: 15,
  mentalFatigue: 5
});

// 3. –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const userMessage = '–Ø —Ö–æ—á—É –ø–æ–º–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å 2 —á–∞—Å–∞';

// 4. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ LLM
const messages = [
  { role: 'system', content: systemPrompt },
  { role: 'user', content: characterContext + '\n\n' + userMessage }
];

const response = await llm.generate(messages);
```

### –ü–æ–ª–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–ø—Ä–∏–º–µ—Ä):

```
[System Prompt - ~2000 —Ç–æ–∫–µ–Ω–æ–≤]
# ROLE: Game Master
–¢—ã ‚Äî –†–∞—Å—Å–∫–∞–∑—á–∏–∫ –≤ –º–∏—Ä–µ –∫—É–ª—å—Ç–∏–≤–∞—Ü–∏–∏...
[–ø—Ä–∞–≤–∏–ª–∞ –º–∏—Ä–∞, —É—Ä–æ–≤–Ω–∏, –∫–æ–º–∞–Ω–¥—ã, —Ñ–æ—Ä–º–∞—Ç]

---

[Character Context - ~200 —Ç–æ–∫–µ–Ω–æ–≤]
# –°–û–°–¢–û–Ø–ù–ò–ï –ü–ï–†–°–û–ù–ê–ñ–ê
- –ò–º—è: –õ–∏–Ω –í—ç–π
- –£—Ä–æ–≤–µ–Ω—å: 1.3 (–ó–∞–∫–∞–ª–∫–∞ —Ç–µ–ª–∞)
- –¶–∏: 350/1000 (35%)
...

---

[User Message]
–Ø —Ö–æ—á—É –ø–æ–º–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å 2 —á–∞—Å–∞
```

### –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:

```json
{
  "type": "narration",
  "content": "–¢—ã –Ω–∞—Ö–æ–¥–∏—à—å —Ç–∏—Ö–æ–µ –º–µ—Å—Ç–æ –ø–æ–¥ —Å—Ç–∞—Ä—ã–º –¥—É–±–æ–º –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—à—å –ø–æ–∑—É –¥–ª—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏. –ó–∞–∫—Ä—ã–≤ –≥–ª–∞–∑–∞, –Ω–∞—á–∏–Ω–∞–µ—à—å —Ä–∏—Ç–º–∏—á–Ω–æ –¥—ã—à–∞—Ç—å, –æ—â—É—â–∞—è –ø–æ—Ç–æ–∫–∏ –¶–∏ –≤ –æ–∫—Ä—É–∂–∞—é—â–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.\n\n–î–≤–∞ —á–∞—Å–∞ –ø—Ä–æ–ª–µ—Ç–∞—é—Ç –Ω–µ–∑–∞–º–µ—Ç–Ω–æ. –ö–æ–≥–¥–∞ —Ç—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—à—å –≥–ª–∞–∑–∞, —Å–æ–ª–Ω—Ü–µ —É–∂–µ –∫–ª–æ–Ω–∏—Ç—Å—è –∫ –∑–∞–∫–∞—Ç—É. –ß—É–≤—Å—Ç–≤—É–µ—à—å, –∫–∞–∫ —è–¥—Ä–æ –Ω–∞–ø–æ–ª–Ω–∏–ª–æ—Å—å —ç–Ω–µ—Ä–≥–∏–µ–π ‚Äî –º–µ–¥–∏—Ç–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ.\n\n–¢–≤–æ—è —ë–º–∫–æ—Å—Ç—å —è–¥—Ä–∞ –Ω–µ–º–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–∏–ª–∞—Å—å –æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏.",
  "qiDelta": {
    "qiChange": 200,
    "reason": "–º–µ–¥–∏—Ç–∞—Ü–∏—è 2 —á–∞—Å–∞"
  },
  "fatigueDelta": {
    "physical": 10,
    "mental": 5
  },
  "timeAdvance": {
    "minutes": 120
  }
}
```

---

## 7. –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞

### –î–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤:
1. **System Prompt** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é
2. **Character State** –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É
3. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã `{{variable}}` –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
4. –ü—Ä–æ–º–ø—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.md` —Ñ–∞–π–ª–∞—Ö –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–ª—è –æ—Ç–≤–µ—Ç–æ–≤ LLM:
1. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –ø–æ–ª–µ `content` ‚Äî —Ç–µ–∫—Å—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞
2. `qiChange` ‚Äî —ç—Ç–æ –ò–ó–ú–ï–ù–ï–ù–ò–ï, –∞ –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
3. –ù–µ –≤—ã—á–∏—Å–ª—è—Ç—å –¶–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ ‚Äî —Ç–æ–ª—å–∫–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –¥–µ–ª—å—Ç—É
4. `isBreakthrough: true` —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø—Ä–æ—Ä—ã–≤–µ
5. –û–ø–∏—Å–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π ‚Äî —Ç–µ–∫—Å—Ç–æ–º, –Ω–µ JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2026-02-24*
