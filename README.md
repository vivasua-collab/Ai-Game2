# 🌸 Cultivation World Simulator

Текстовая RPG-симуляция мира культивации с ИИ-гейм-мастером. Погрузитесь в мир сянся, где вы можете развиваться от пробуждённого ядра до бессмертия.

## ✨ Особенности

### 🎮 Игровой процесс
- **📖 Живое повествование** — ИИ-рассказчик создаёт уникальную историю
- **⚡ Система Ци** — детальная физика энергии с формулами
- **🏔️ 10 уровней культивации** — от Пробуждённого Ядра до Бессмертия
- **🗺️ Огромный мир** — 100,000 км обитаемых земель
- **👥 NPC и секты** — социальные структуры и отношения

### 🤖 ИИ-Гейм-Мастер
- Поддержка нескольких провайдеров LLM
- Локальная LLM (Ollama)
- Внешние API (OpenAI и др.)
- z-ai-web-dev-sdk

### 🎨 Интерфейс
- Минималистичный текстовый UI
- Тёмная тема
- Адаптивный дизайн
- Сохранение/загрузка

## 🚀 Быстрый старт

```bash
# Установка зависимостей
bun install

# Инициализация базы данных
bun run db:push

# Запуск сервера разработки
bun run dev
```

Откройте [http://localhost:3000](http://localhost:3000) в браузере.

> 📖 **Подробная инструкция по установке:** [Install.md](./Install.md) — полное руководство для Windows, Linux и macOS.

## 🎯 Варианты старта

### 1. 🏛️ В секте
- Пробуждение в теле кандидата
- Частичная амнезия
- 4 дня испытаний
- Не знает о системе

### 2. 🌲 Свободный старт
- Случайная локация
- Знает о системе
- Минимальные ресурсы

### 3. ⚙️ Кастомный
- Выбор локации
- Настройка характеристик
- Полный контроль

## 📋 Система команд

| Команда | Описание |
|---------|----------|
| `!!` | Действие для ГГ (системное сообщение) |
| `--` | Глобальный запрос к симуляции |
| `---` | Строгий режим вывода |
| `--ПМ` | Проверка мира |

## 🏗️ Технологии

### Основной стек
- **Next.js 16** — React-фреймворк с App Router
- **TypeScript 5** — типобезопасный JavaScript
- **Tailwind CSS 4** — стилизация
- **Prisma** — ORM для базы данных
- **SQLite** — хранение данных

### UI компоненты
- **shadcn/ui** — компоненты интерфейса
- **Lucide React** — иконки
- **Framer Motion** — анимации

### AI интеграция
- **z-ai-web-dev-sdk** — основной провайдер
- **Ollama** — локальная LLM
- **OpenAI API** — внешний API

## 📁 Структура проекта

```
src/
├── app/                    # Next.js App Router
│   ├── page.tsx           # Главная страница
│   └── api/               # API endpoints
│       ├── chat/          # API чата
│       └── game/          # API игры
├── components/
│   ├── game/              # Игровые компоненты
│   ├── start/             # Экран старта
│   └── ui/                # shadcn/ui компоненты
├── data/
│   ├── memory-containers.ts  # Контейнеры памяти
│   ├── cultivation-levels.ts # Уровни культивации
│   └── prompts/           # Промпты для ИИ
├── hooks/                 # React хуки
└── lib/
    ├── llm/               # LLM провайдеры
    ├── game/              # Игровая логика
    └── image/             # Генерация изображений
```

## ⚙️ Конфигурация LLM

### z-ai-web-dev-sdk (по умолчанию)
Работает автоматически без настройки.

### Локальная LLM (Ollama)
```bash
# Установка Ollama
curl -fsSL https://ollama.com/install.sh | sh

# Загрузка модели
ollama pull llama3.1:8b

# Запуск сервера
ollama serve
```

### Внешний API
Создайте файл `.env.local`:
```env
LLM_PROVIDER=api
LLM_API_ENDPOINT=https://api.openai.com/v1/chat/completions
LLM_API_KEY=your-api-key
LLM_API_MODEL=gpt-4
```

## 📊 Система культивации

| Уровень | Название | Плотность Ци |
|---------|----------|--------------|
| 1 | Пробуждённое Ядро | 1 ед/см³ |
| 2 | Течение Жизни | 2 ед/см³ |
| 3 | Пламя Внутреннего Огня | 4 ед/см³ |
| 4 | Объединение Тела и Духа | 8 ед/см³ |
| 5 | Сердце Небес | 16 ед/см³ |
| 6 | Разрыв Пелены | 32 ед/см³ |
| 7 | Вечное Кольцо | 64 ед/см³ |
| 8 | Глас Небес | 128 ед/см³ |
| 9 | Бессмертное Ядро | 256 ед/см³ |

### Формулы
- **Плотность Ци:** `Qi(x) = 2^(уровень-1)` ед/см³
- **Прорыв (малый):** ёмкость ядра × 10
- **Прорыв (большой):** ёмкость ядра × 100
- **Генерация:** 10% от ёмкости ядра/сутки

## 🗺️ География мира

```
┌─────────────────────────────────────────────┐
│                 КУПОЛ (10,000 км)           │
│  ┌─────────────────────────────────────┐    │
│  │     Внутреннее кольцо (0-5,000 км)  │    │
│  │     Ци: 500-1000+ ед/м³             │    │
│  │     Макс. уровень: 9.0-9.9          │    │
│  │  ┌─────────────────────────────┐    │    │
│  │  │  Среднее кольцо             │    │    │
│  │  │  (5,000-15,000 км)          │    │    │
│  │  │  Ци: 200-500 ед/м³          │    │    │
│  │  │  Макс. уровень: 7.0-8.0     │    │    │
│  │  │  ┌─────────────────────┐    │    │    │
│  │  │  │  Внешнее кольцо     │    │    │    │
│  │  │  │  (15,000-20,000 км) │    │    │    │
│  │  │  │  Ци: 100-200 ед/м³  │    │    │    │
│  │  │  │  ┌─────────────┐    │    │    │    │
│  │  │  │  │ Приграничье │    │    │    │    │
│  │  │  │  │ (20-100к км)│    │    │    │    │
│  │  │  │  │ Ци: 20-100  │    │    │    │    │
│  │  │  │  └─────────────┘    │    │    │    │
│  │  │  └─────────────────────┘    │    │    │
│  │  └─────────────────────────────┘    │    │
│  └─────────────────────────────────────┘    │
│              Бесконечное Море               │
│               (20,000 км)                   │
└─────────────────────────────────────────────┘
```

## 🔮 Планы развития

- [ ] Боевая система
- [ ] Система техник Ци
- [ ] Генерация изображений (Stable Diffusion)
- [ ] Карта мира
- [ ] Мультиплеер
- [ ] Звуковое сопровождение

## 📚 Документация

- **[HISTORY.md](./HISTORY.md)** — история обновлений и версионирование
- **[Install.md](./Install.md)** — подробная инструкция по установке
- **[worklog.md](./worklog.md)** — рабочий лог разработки

## 📜 Лицензия

MIT License

---

Создано с ❤️ для любителей жанра сянся. Powered by [Z.ai](https://chat.z.ai) 🚀
