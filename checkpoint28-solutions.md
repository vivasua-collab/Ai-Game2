# üõ†Ô∏è –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏–π –¥–ª—è —á–µ–∫–ø–æ–∏–Ω—Ç–∞ 28

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2026-02-28  
**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏–∑

---

## ‚ö†Ô∏è –ö–æ–Ω—Ç–µ–∫—Å—Ç

**–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Ö–Ω–∏–∫ ‚Äî –æ–±–æ—Å–æ–±–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç.**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–≥—Ä–æ–π (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ `presets/`)
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –ù–ï –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç –∏–≥—Ä–æ–≤—É—é –ª–æ–≥–∏–∫—É
- –í –±—É–¥—É—â–µ–º –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –æ–±–æ—Å–æ–±–ª–µ–Ω–∏–µ (—Å—Ç–∞—Ç—É—Å: ‚è∏Ô∏è –ù–∞ –ø–∞—É–∑–µ)

---

## 1Ô∏è‚É£ –ü–†–û–ë–õ–ï–ú–ê: –ò–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç A: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ

**–ü—Ä–∏–Ω—Ü–∏–ø:** –û—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤, –¥–æ–±–∞–≤–∏–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é.

```typescript
async clearByType(type: TechniqueType): Promise<number> {
  // 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —Ç–µ—Ö–Ω–∏–∫–∏
  const all = await this.loadTechniques();
  
  // 2. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å - –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ù–ï —É–¥–∞–ª—è–µ–º—ã–π —Ç–∏–ø
  const remaining = all.filter(t => t.type !== type);
  
  // 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ
  await this.saveTechniques(remaining, 'replace');
  
  return all.length - remaining.length;
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
- ‚úÖ –ù–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö (—á—Ç–µ–Ω–∏–µ –≤—Å–µ–≥–æ ‚Üí —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è ‚Üí –∑–∞–ø–∏—Å—å –≤—Å–µ–≥–æ)
- ‚ùå –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê (3/5)

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø–æ —Ç–∏–ø–∞–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ö–∞–∂–¥—ã–π —Ç–∏–ø –≤ —Å–≤–æ—ë–º —Ñ–∞–π–ª–µ/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

```typescript
// –°—Ç—Ä—É–∫—Ç—É—Ä–∞
presets/techniques/
  combat/level-1.json
  defense/level-1.json
  healing/level-1.json
  ...

// –ú–µ—Ç–æ–¥ –æ—á–∏—Å—Ç–∫–∏
async clearByType(type: TechniqueType): Promise<number> {
  const typeDir = path.join(DATA_DIR, 'techniques', type);
  let deleted = 0;
  
  // –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∏–ø–∞
  const files = await fs.readdir(typeDir);
  for (const file of files) {
    await fs.unlink(path.join(typeDir, file));
    deleted++;
  }
  
  return deleted;
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ—á–∏—Å—Ç–∫–∞ (—É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –±–µ–∑ —á—Ç–µ–Ω–∏—è)
- ‚úÖ –õ–æ–≥–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã
- ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–º —Ç–∏–ø–æ–º

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ë–æ–ª—å—à–µ —Ñ–∞–π–ª–æ–≤

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

---

### –í–∞—Ä–∏–∞–Ω—Ç C: –ò–Ω–¥–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ï–¥–∏–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏–∫.

```typescript
// index.json
{
  "techniques": {
    "TC_000001": { file: "level-1.json", offset: 0 },
    "TC_000002": { file: "level-1.json", offset: 1 },
    ...
  }
}

// –û—á–∏—Å—Ç–∫–∞
async clearByType(type: TechniqueType): Promise<number> {
  // 1. –ù–∞–π—Ç–∏ –≤—Å–µ ID —Ç–µ—Ö–Ω–∏–∫ –Ω—É–∂–Ω–æ–≥–æ —Ç–∏–ø–∞ —á–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å
  const ids = this.index.findByType(type);
  
  // 2. –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω—ã–µ (soft delete)
  for (const id of ids) {
    this.index.markDeleted(id);
  }
  
  // 3. –ö–æ–º–ø–∞–∫—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
  await this.compact();
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫
- ‚úÖ Soft delete (–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚ùå –ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –∏–Ω–¥–µ–∫—Å
- ‚ùå –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê (2/5)

---

## 2Ô∏è‚É£ –ü–†–û–ë–õ–ï–ú–ê: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞—Ç–∞–∫—É—é—â–∏—Ö —Ç–µ—Ö–Ω–∏–∫

### –í–∞—Ä–∏–∞–Ω—Ç A: –ü–æ–¥—Ç–∏–ø—ã –∫–∞–∫ –ø–æ–¥–ø–∞–ø–∫–∏

```typescript
presets/techniques/combat/
  melee-strike/
    level-1.json
    level-2.json
  melee-weapon/
    level-1.json
    level-2.json
  ranged/
    level-1.json
    level-2.json
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ß—ë—Ç–∫–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è
- ‚úÖ –õ–µ–≥–∫–æ –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–¥—Ç–∏–ø

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ì–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å (4 —É—Ä–æ–≤–Ω—è)
- ‚ùå –ú–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –ü–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º —Ñ–∞–π–ª–∞

```typescript
presets/techniques/
  combat-melee-strike-level-1.json
  combat-melee-weapon-level-1.json
  combat-ranged-level-1.json
  defense-level-1.json
  healing-level-1.json
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ú–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- ‚ùå –î–ª–∏–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê (3/5)

---

### –í–∞—Ä–∏–∞–Ω—Ç C: –ì–∏–±—Ä–∏–¥–Ω—ã–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```typescript
presets/techniques/
  combat/
    melee-strike-level-1.json    // –£–¥–∞—Ä —Ç–µ–ª–æ–º
    melee-weapon-level-1.json    // –û—Ä—É–∂–µ–π–Ω—ã–µ
    ranged-level-1.json          // –î–∞–ª—å–Ω–∏–µ
  defense/
    level-1.json
  healing/
    level-1.json
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è combat (–≥–¥–µ —ç—Ç–æ –Ω—É–∂–Ω–æ)
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ –õ–æ–≥–∏—á–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ–º–Ω–æ–≥–æ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

---

## 3Ô∏è‚É£ –ü–†–û–ë–õ–ï–ú–ê: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ä—É–∂–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç A: –¢–µ—Ö–Ω–∏–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π

```typescript
interface WeaponTechnique {
  weaponCategory: WeaponCategory;  // one_handed_blade
  weaponBonuses: Record<WeaponType, WeaponBonus>;
}

// –ü—Ä–∏–º–µ—Ä
{
  id: "MW_000042",
  name: "–í–∏—Ö—Ä—å –∫–ª–∏–Ω–∫–æ–≤",
  weaponCategory: "one_handed_blade",
  weaponBonuses: {
    sword:  { damage: 1.0, speed: 1.0 },
    blade:  { damage: 0.95, speed: 1.1 },
    dagger: { damage: 0.7, speed: 1.4 }
  }
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –¢–µ—Ö–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏ –æ—Ä—É–∂–∏—è
- ‚úÖ –Ø–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ë–æ–ª—å—à–æ–π –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å UI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –ë–æ–Ω—É—Å—ã –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏

```typescript
interface WeaponTechnique {
  weaponCategory: WeaponCategory;
  // –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Ö–Ω–∏–∫–∏
  baseDamage: number;
  baseRange: number;
}

// –ë–æ–Ω—É—Å—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
function applyWeaponBonus(
  technique: WeaponTechnique,
  weaponType: WeaponType
): ComputedTechnique {
  const categoryConfig = WEAPON_CATEGORIES[technique.weaponCategory];
  const weaponBonus = categoryConfig.weaponBonuses[weaponType];
  
  return {
    damage: technique.baseDamage * weaponBonus.damageMod,
    range: technique.baseRange * weaponBonus.rangeMod,
    speed: weaponBonus.speedMod,
  };
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ—Ö–Ω–∏–∫–µ
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–∞–º–∏
- ‚úÖ –õ–µ–≥–∫–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ú–µ–Ω–µ–µ –≥–∏–±–∫–æ (–Ω–µ–ª—å–∑—è –∑–∞–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã –¥–ª—è —Ç–µ—Ö–Ω–∏–∫–∏)
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

---

### –í–∞—Ä–∏–∞–Ω—Ç C: –¢–µ–≥–∏ –≤–º–µ—Å—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

```typescript
interface WeaponTechnique {
  // –¢–µ–≥–∏ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  compatibleTags: string[];  // ['blade', 'one_handed', 'metal']
  
  // –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –¥–ª—è —Ç–µ–≥–æ–≤
  tagBonuses: Record<string, number>;
}

// –û—Ä—É–∂–∏–µ –∏–º–µ–µ—Ç —Ç–µ–≥–∏
const sword = { tags: ['blade', 'one_handed', 'metal'] };
const dagger = { tags: ['blade', 'one_handed', 'metal', 'short'] };

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
function isCompatible(technique, weapon) {
  return technique.compatibleTags.every(tag => weapon.tags.includes(tag));
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å UI
- ‚ùå Overengineering –¥–ª—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê (2/5)

---

## 4Ô∏è‚É£ –ü–†–û–ë–õ–ï–ú–ê: –ù–æ–≤—ã–µ ID –¥–ª—è –∞—Ç–∞–∫—É—é—â–∏—Ö —Ç–µ—Ö–Ω–∏–∫

### –í–∞—Ä–∏–∞–Ω—Ç A: –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

```typescript
// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞—Ä—ã—Ö —Ç–µ—Ö–Ω–∏–∫
function migrateTechnique(tech: OldTechnique): NewTechnique {
  let newPrefix: string;
  
  if (tech.type === 'combat') {
    switch (tech.subtype) {
      case 'melee_strike': newPrefix = 'MS'; break;
      case 'melee_weapon': newPrefix = 'MW'; break;
      case 'ranged_projectile':
      case 'ranged_beam':
      case 'ranged_aoe': newPrefix = 'RG'; break;
      default: newPrefix = 'TC';
    }
  } else {
    newPrefix = TYPE_ID_PREFIX[tech.type];
  }
  
  const newId = idService.generateId(newPrefix);
  
  return { ...tech, id: newId, oldId: tech.id };
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ß–∏—Å—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ ID
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –í—Å–µ —Å—Ç–∞—Ä—ã–µ ID —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏
- ‚ùå –°–≤—è–∑–∏ –≤ –ë–î –º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å—Å—è

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê (3/5)

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –ù–æ–≤—ã–µ ID —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–µ—Ö–Ω–∏–∫

```typescript
// –°—Ç–∞—Ä—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å—Ç–∞—Ä—ã–µ ID
// –ù–æ–≤—ã–µ –ø–æ–ª—É—á–∞—é—Ç –Ω–æ–≤—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã

function generateId(technique: Technique): string {
  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–µ—Ñ–∏–∫—Å –ø–æ —Ç–∏–ø—É/–ø–æ–¥—Ç–∏–ø—É
  const prefix = getPrefixForTechnique(technique);
  
  // –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç–∞—Ä—ã–π —Ç–∏–ø - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ä—ã–π —Å—á—ë—Ç—á–∏–∫
  if (isLegacyType(technique)) {
    return legacyIdService.generateId('TC');
  }
  
  // –ò–Ω–∞—á–µ –Ω–æ–≤—ã–π —Å—á—ë—Ç—á–∏–∫
  return idService.generateId(prefix);
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ù–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –î–≤–µ —Å–∏—Å—Ç–µ–º—ã ID –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚ùå –ü—É—Ç–∞–Ω–∏—Ü–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê (2/5)

---

### –í–∞—Ä–∏–∞–Ω—Ç C: –ì–∏–±—Ä–∏–¥–Ω—ã–π —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –º–∞–ø–ø–∏–Ω–≥–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```typescript
// –•—Ä–∞–Ω–∏–º –º–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ä—ã—Ö ID –∫ –Ω–æ–≤—ã–º
interface IdMapping {
  oldId: string;
  newId: string;
  migratedAt: string;
}

// –ü—Ä–∏ –ø–µ—Ä–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
async function migrateWithMapping(): Promise<void> {
  const mappings: IdMapping[] = [];
  
  for (const tech of oldTechniques) {
    const newPrefix = getNewPrefix(tech);
    const newId = idService.generateId(newPrefix);
    
    mappings.push({
      oldId: tech.id,
      newId,
      migratedAt: new Date().toISOString()
    });
    
    tech.id = newId;
    tech.oldId = tech.id;  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å—Å—ã–ª–æ–∫
  }
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞–ø–ø–∏–Ω–≥
  await saveMapping(mappings);
}

// –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø–æ —Å—Ç–∞—Ä–æ–º—É ID
function resolveId(id: string): Technique {
  // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –Ω–∞–ø—Ä—è–º—É—é
  let tech = findById(id);
  if (tech) return tech;
  
  // –ò—â–µ–º –≤ –º–∞–ø–ø–∏–Ω–≥–µ
  const mapping = findMapping(id);
  if (mapping) return findById(mapping.newId);
  
  return null;
}
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –º–∞–ø–ø–∏–Ω–≥
- ‚úÖ –ß–∏—Å—Ç–∞—è –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –º–∞–ø–ø–∏–Ω–≥–∞
- ‚ùå –ù–µ–±–æ–ª—å—à–æ–µ —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ –∫–æ–¥–∞

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

---

## 5Ô∏è‚É£ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–û–ï –†–ï–®–ï–ù–ò–ï

### –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ | –í–∞—Ä–∏–∞–Ω—Ç |
|----------|---------|---------|
| –ò–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ | –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø–æ —Ç–∏–ø–∞–º | B |
| –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞—Ç–∞–∫—É—é—â–∏—Ö —Ç–µ—Ö–Ω–∏–∫ | –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | C |
| –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ä—É–∂–∏—è | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –±–æ–Ω—É—Å—ã | B |
| –ù–æ–≤—ã–µ ID | –ú–∞–ø–ø–∏–Ω–≥ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ | C |

### –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
presets/
‚îú‚îÄ‚îÄ manifest.json
‚îú‚îÄ‚îÄ counters.json
‚îú‚îÄ‚îÄ id-mapping.json           # NEW: –º–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ä—ã—Ö ID
‚îÇ
‚îú‚îÄ‚îÄ techniques/
‚îÇ   ‚îú‚îÄ‚îÄ combat/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ melee-strike/     # MS_ prefix
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ level-1.json
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ level-2.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ melee-weapon/     # MW_ prefix
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ranged/           # RG_ prefix
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ defense/              # DF_ prefix
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ level-1.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ ... (–¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã)
‚îÇ
‚îî‚îÄ‚îÄ weapon-categories.json     # NEW: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```

---

## 6Ô∏è‚É£ –ü–û–†–Ø–î–û–ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è)
1. –°–æ–∑–¥–∞—Ç—å `weapon-categories.ts` —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ –±–æ–Ω—É—Å–∞–º–∏
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ ID
3. –ù–∞–ø–∏—Å–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (dry-run)

### –§–∞–∑–∞ 2: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
1. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `preset-storage.ts`:
   - –î–æ–±–∞–≤–∏—Ç—å `saveTechniquesByType()`
   - –î–æ–±–∞–≤–∏—Ç—å `loadTechniquesByType()`
   - –î–æ–±–∞–≤–∏—Ç—å `clearByType()`
2. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –§–∞–∑–∞ 3: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä
1. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `technique-generator.ts`:
   - –ù–æ–≤—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã ID
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—Ä—É–∂–∏—è
2. –û–±–Ω–æ–≤–∏—Ç—å API endpoints

### –§–∞–∑–∞ 4: UI
1. –û–±–Ω–æ–≤–∏—Ç—å `TechniqueGeneratorPanel.tsx`:
   - –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ä—É–∂–∏—è –≤–º–µ—Å—Ç–æ —Ç–∏–ø–∞
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏
2. –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –æ—Ä—É–∂–∏—è

### –§–∞–∑–∞ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
3. –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

*–î–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏*
